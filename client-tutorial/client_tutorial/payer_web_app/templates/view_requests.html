{% extends "dark_layout.html" %}

{% block content %}

<!--
  ~ Copyright (c) 2021 IBM Corporation
  ~ Henry Feldman, MD (CMO Development, IBM Watson Health)
  -->

<!-- Breadcrumb-->
    <div class="container-fluid">
<nav class="navbar navbar-expand-lg navbar-light bg-light">
<ol class="breadcrumb">
    <li class="breadcrumb-item">Home</li>
    <li class="breadcrumb-item">
        <a href="/payer">Payer</a>
    </li>
    <li class="breadcrumb-item active"><a href="/coverage?payerId">Coverage</a></li>
    <!-- Breadcrumb Menu-->
</ol>
</nav>
    <div class="row">

        <H2>Selected Payer: {{ payer['Name'] }} </H2>
        <b>Member Count: </b> {{ memberCount }}
<table class="table table-striped table-hover">
<thead>
    <th scope=""col">Member Id</th>
    <th scope=""col">Member First</th>
    <th scope=""col">Member Last</th>
    <th scope=""col">Plan/Coverage</th>
    <th scope=""col">Request Type</th>
    <th scope=""col">Coverage Detail</th>
    </thead>
    <tbody>
    {% for tuple in patientCoverageTupleList %}
    <tr class="table-active">
      <th scope="row">{{ tuple.1.member_id }}</th>
      <td>{{ tuple.0.first_name }}</td>
      <td>{{ tuple.0.last_name }}</td>
      <td>{{ tuple.1.payer_plan_id }} </td>
      <td>{{ requestDict[tuple.1.member_id][0].request_service_type }}</td>
      <td>
          {% if tuple.0.acd_study_patient==1: %}
              {% if tuple.1.member_id in requestDict and requestDict[tuple.1.member_id]|count > 1 %}
              <p><a href="/coveragedetail?coverageId={{ tuple.1.id }}" class="pe-auto">View Details &check; </a> <span class="badge rounded-pill bg-primary">{{ requestDict[tuple.1.member_id]|count -1 }}</span></p>
              {% else %}
              <p><a href="/coveragedetail?coverageId={{ tuple.1.id }}" class="text-reset">View Details &check;</a></p>
              {% endif %}
          {% else: %}
              {% if tuple.1.member_id in requestDict and requestDict[tuple.1.member_id]|count > 1 %}
                <p><a href="/coveragedetail?coverageId={{ tuple.1.id }}" class="pe-auto">View Details </a> <span class="badge rounded-pill bg-primary">{{ requestDict[tuple.1.member_id]|count -1 }}</span></p>
              {% else %}
                <p><a href="/coveragedetail?coverageId={{ tuple.1.id }}" class="text-reset">View Details</a></p>
              {% endif %}
          {% endif %}
      </td>

    </tr>
    {% endfor %}
    </tbody>
</table>
    </div>
</div>

{% endblock %}
